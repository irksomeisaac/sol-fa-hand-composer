{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\sol-fa-app\\\\src\\\\components\\\\EnhancedHandDetection.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useState, useCallback } from 'react';\nimport Webcam from 'react-webcam';\nimport * as hands from '@mediapipe/hands';\nimport * as camera from '@mediapipe/camera_utils';\nimport { drawConnectors, drawLandmarks } from '@mediapipe/drawing_utils';\nimport { recognizeKodalySign } from '../utils/kodalySignsDB';\nimport { audioPlayer } from '../utils/audioUtils';\nimport './HandDetection.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CONFIDENCE_THRESHOLD = 0.85;\nconst HOLD_FRAMES = 10;\nfunction EnhancedHandDetection() {\n  _s();\n  const webcamRef = useRef(null);\n  const canvasRef = useRef(null);\n  const handsRef = useRef(null);\n  const cameraRef = useRef(null);\n  const voiceRecognitionRef = useRef(null);\n  const [detectionState, setDetectionState] = useState({\n    sign: null,\n    confidence: 0,\n    debug: null,\n    handPresent: false\n  });\n  const [voiceState, setVoiceState] = useState({\n    isActive: false,\n    lastCommand: null,\n    isSupported: false\n  });\n  const [compositionState, setCompositionState] = useState({\n    notes: [],\n    currentOctave: 4,\n    isRecording: false\n  });\n  const lastSignRef = useRef(null);\n  const frameCountRef = useRef(0);\n\n  // Voice command handler\n  const handleVoiceCommand = useCallback(transcript => {\n    console.log('Voice command:', transcript);\n    if (transcript.includes('add') && detectionState.sign) {\n      // Add current note to composition\n      setCompositionState(prev => ({\n        ...prev,\n        notes: [...prev.notes, {\n          note: detectionState.sign,\n          octave: prev.currentOctave,\n          timestamp: Date.now()\n        }]\n      }));\n      audioPlayer.playUIFeedback(1200, 200);\n      setVoiceState(prev => ({\n        ...prev,\n        lastCommand: 'Added note: ' + detectionState.sign.toUpperCase()\n      }));\n    } else if (transcript.includes('octave up') || transcript.includes('higher')) {\n      setCompositionState(prev => ({\n        ...prev,\n        currentOctave: Math.min(prev.currentOctave + 1, 7)\n      }));\n      audioPlayer.playUIFeedback(1000);\n      setVoiceState(prev => ({\n        ...prev,\n        lastCommand: 'Octave up'\n      }));\n    } else if (transcript.includes('octave down') || transcript.includes('lower')) {\n      setCompositionState(prev => ({\n        ...prev,\n        currentOctave: Math.max(prev.currentOctave - 1, 2)\n      }));\n      audioPlayer.playUIFeedback(600);\n      setVoiceState(prev => ({\n        ...prev,\n        lastCommand: 'Octave down'\n      }));\n    } else if (transcript.includes('play') || transcript.includes('playback')) {\n      playComposition();\n      setVoiceState(prev => ({\n        ...prev,\n        lastCommand: 'Playing composition'\n      }));\n    } else if (transcript.includes('clear') || transcript.includes('reset')) {\n      setCompositionState(prev => ({\n        ...prev,\n        notes: []\n      }));\n      audioPlayer.playUIFeedback(400, 300);\n      setVoiceState(prev => ({\n        ...prev,\n        lastCommand: 'Composition cleared'\n      }));\n    } else if (transcript.includes('undo') || transcript.includes('remove last')) {\n      setCompositionState(prev => ({\n        ...prev,\n        notes: prev.notes.slice(0, -1)\n      }));\n      audioPlayer.playUIFeedback(500);\n      setVoiceState(prev => ({\n        ...prev,\n        lastCommand: 'Last note removed'\n      }));\n    }\n  }, [detectionState.sign]);\n  const playComposition = useCallback(() => {\n    if (compositionState.notes.length === 0) {\n      audioPlayer.playUIFeedback(400, 300);\n      return;\n    }\n    compositionState.notes.forEach((noteItem, index) => {\n      setTimeout(() => {\n        audioPlayer.playNote(noteItem.note, noteItem.octave);\n        setTimeout(() => audioPlayer.stopNote(), 400);\n      }, index * 500);\n    });\n  }, [compositionState.notes]);\n  const handleSignDetection = useCallback(recognition => {\n    const currentSign = recognition === null || recognition === void 0 ? void 0 : recognition.sign;\n    const confidence = (recognition === null || recognition === void 0 ? void 0 : recognition.confidence) || 0;\n    if (currentSign && confidence >= CONFIDENCE_THRESHOLD) {\n      if (currentSign === lastSignRef.current) {\n        frameCountRef.current++;\n        if (frameCountRef.current >= HOLD_FRAMES) {\n          audioPlayer.playNote(currentSign, compositionState.currentOctave);\n        }\n      } else {\n        frameCountRef.current = 0;\n        lastSignRef.current = currentSign;\n        audioPlayer.stopNote();\n      }\n    } else {\n      frameCountRef.current = 0;\n      lastSignRef.current = null;\n      audioPlayer.stopNote();\n    }\n  }, [compositionState.currentOctave]);\n  const onResults = useCallback(results => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx.save();\n    ctx.scale(-1, 1);\n    ctx.translate(-canvas.width, 0);\n    if (results.image) {\n      ctx.drawImage(results.image, 0, 0, canvas.width, canvas.height);\n    }\n    if (results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {\n      for (const landmarks of results.multiHandLandmarks) {\n        drawConnectors(ctx, landmarks, hands.HAND_CONNECTIONS, {\n          color: '#00FF00',\n          lineWidth: 5\n        });\n        drawLandmarks(ctx, landmarks, {\n          color: '#FF0000',\n          lineWidth: 2\n        });\n        const mirroredLandmarks = landmarks.map(landmark => ({\n          ...landmark,\n          x: 1 - landmark.x\n        }));\n        const recognition = recognizeKodalySign(mirroredLandmarks);\n        handleSignDetection(recognition);\n        setDetectionState({\n          ...recognition,\n          handPresent: true\n        });\n      }\n    } else {\n      handleSignDetection(null);\n      setDetectionState({\n        sign: null,\n        confidence: 0,\n        debug: null,\n        handPresent: false\n      });\n    }\n    ctx.restore();\n  }, [handleSignDetection]);\n  useEffect(() => {\n    if (!webcamRef.current) return;\n\n    // Fixed MediaPipe loading for GitHub Pages\n    handsRef.current = new hands.Hands({\n      locateFile: file => {\n        // Try multiple CDN sources for reliability\n        return `https://cdn.jsdelivr.net/npm/@mediapipe/hands@0.4.1646424915/${file}`;\n      }\n    });\n    handsRef.current.setOptions({\n      maxNumHands: 1,\n      modelComplexity: 1,\n      minDetectionConfidence: 0.7,\n      minTrackingConfidence: 0.7\n    });\n    handsRef.current.onResults(onResults);\n    if (webcamRef.current) {\n      cameraRef.current = new camera.Camera(webcamRef.current.video, {\n        onFrame: async () => {\n          if (webcamRef.current && handsRef.current) {\n            await handsRef.current.send({\n              image: webcamRef.current.video\n            });\n          }\n        },\n        width: 640,\n        height: 480\n      });\n      cameraRef.current.start();\n    }\n\n    // Setup voice recognition automatically\n    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {\n      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n      voiceRecognitionRef.current = new SpeechRecognition();\n      voiceRecognitionRef.current.continuous = true;\n      voiceRecognitionRef.current.interimResults = false;\n      voiceRecognitionRef.current.lang = 'en-US';\n      voiceRecognitionRef.current.onresult = event => {\n        const transcript = event.results[event.results.length - 1][0].transcript.toLowerCase().trim();\n        handleVoiceCommand(transcript);\n      };\n      voiceRecognitionRef.current.onerror = () => {\n        setTimeout(() => {\n          try {\n            voiceRecognitionRef.current.start();\n          } catch (e) {}\n        }, 1000);\n      };\n      voiceRecognitionRef.current.onend = () => {\n        setTimeout(() => {\n          try {\n            voiceRecognitionRef.current.start();\n          } catch (e) {}\n        }, 100);\n      };\n\n      // Auto-start voice recognition\n      setTimeout(() => {\n        try {\n          voiceRecognitionRef.current.start();\n          setVoiceState(prev => ({\n            ...prev,\n            isActive: true,\n            isSupported: true\n          }));\n          console.log('Voice recognition auto-started');\n        } catch (error) {\n          console.error('Voice recognition failed to start:', error);\n        }\n      }, 2000);\n    }\n    return () => {\n      if (cameraRef.current) {\n        cameraRef.current.stop();\n      }\n      if (handsRef.current) {\n        handsRef.current.close();\n      }\n      if (voiceRecognitionRef.current) {\n        voiceRecognitionRef.current.stop();\n      }\n      audioPlayer.stopNote();\n    };\n  }, [onResults, handleVoiceCommand]);\n  const renderDebugInfo = useCallback(() => {\n    if (!detectionState.handPresent) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"debug-panel\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"status-message\",\n          children: \"No Hand Detected\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"debug-data\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Waiting for hand to appear in frame...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 17\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"debug-panel\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"status-message\",\n        children: detectionState.sign ? `Detected: ${detectionState.sign.toUpperCase()}${compositionState.currentOctave} (${Math.round(detectionState.confidence * 100)}% confident)` : \"Hand Detected - No Sign Recognized\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"debug-data\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Hand Analysis:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 21\n        }, this), detectionState.debug && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"debug-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"Finger Extensions:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 33\n            }, this), Object.entries(detectionState.debug.extensions).map(([finger, value]) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"debug-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: [finger, \":\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 298,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"debug-bar\",\n                style: {\n                  width: `${value * 100}%`\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 299,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: [Math.round(value * 100), \"%\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 300,\n                columnNumber: 41\n              }, this)]\n            }, finger, true, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 37\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 294,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"debug-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"Voice Commands:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 305,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `voice-status ${voiceState.isActive ? 'active' : 'inactive'}`,\n              children: voiceState.isSupported ? voiceState.isActive ? '🎤 Voice Active' : '🎤 Starting...' : '❌ Not Supported'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 306,\n              columnNumber: 33\n            }, this), voiceState.lastCommand && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"last-command\",\n              children: voiceState.lastCommand\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"voice-commands-list\",\n              children: /*#__PURE__*/_jsxDEV(\"small\", {\n                children: \"Say: \\\"Add\\\" | \\\"Octave up\\\" | \\\"Octave down\\\" | \\\"Play\\\" | \\\"Clear\\\" | \\\"Undo\\\"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 318,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 317,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"debug-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"Composition:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 324,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Octave: \", compositionState.currentOctave]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 325,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Notes: \", compositionState.notes.length]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 326,\n              columnNumber: 33\n            }, this), compositionState.notes.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"composition-preview\",\n              children: [compositionState.notes.slice(-5).map((note, index) => /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"note-item\",\n                children: [note.note.toUpperCase(), note.octave]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 330,\n                columnNumber: 45\n              }, this)), compositionState.notes.length > 5 && /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 334,\n                columnNumber: 79\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 328,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 323,\n            columnNumber: 29\n          }, this), detectionState.sign && frameCountRef.current >= HOLD_FRAMES && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"debug-section playing\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"Playing Note:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 340,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [detectionState.sign.toUpperCase(), compositionState.currentOctave]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 341,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 339,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 290,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 13\n    }, this);\n  }, [detectionState, voiceState, compositionState]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"hand-detection\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"camera-canvas-container\",\n        children: [/*#__PURE__*/_jsxDEV(Webcam, {\n          ref: webcamRef,\n          style: {\n            display: 'none'\n          },\n          width: 640,\n          height: 480,\n          mirrored: false\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: canvasRef,\n          width: 640,\n          height: 480\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 21\n        }, this), detectionState.sign && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `sign-indicator ${frameCountRef.current >= HOLD_FRAMES ? 'playing' : ''}`,\n          children: /*#__PURE__*/_jsxDEV(\"h2\", {\n            children: [detectionState.sign.toUpperCase(), compositionState.currentOctave]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 369,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 25\n        }, this), voiceState.isActive && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"voice-indicator\",\n          children: \"\\uD83C\\uDFA4 Voice Active\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 17\n      }, this), renderDebugInfo()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 352,\n    columnNumber: 9\n  }, this);\n}\n_s(EnhancedHandDetection, \"X4Q+wH7TTjKEvMHDxH3BnRLbUzI=\");\n_c = EnhancedHandDetection;\nexport default EnhancedHandDetection;\nvar _c;\n$RefreshReg$(_c, \"EnhancedHandDetection\");","map":{"version":3,"names":["React","useRef","useEffect","useState","useCallback","Webcam","hands","camera","drawConnectors","drawLandmarks","recognizeKodalySign","audioPlayer","jsxDEV","_jsxDEV","Fragment","_Fragment","CONFIDENCE_THRESHOLD","HOLD_FRAMES","EnhancedHandDetection","_s","webcamRef","canvasRef","handsRef","cameraRef","voiceRecognitionRef","detectionState","setDetectionState","sign","confidence","debug","handPresent","voiceState","setVoiceState","isActive","lastCommand","isSupported","compositionState","setCompositionState","notes","currentOctave","isRecording","lastSignRef","frameCountRef","handleVoiceCommand","transcript","console","log","includes","prev","note","octave","timestamp","Date","now","playUIFeedback","toUpperCase","Math","min","max","playComposition","slice","length","forEach","noteItem","index","setTimeout","playNote","stopNote","handleSignDetection","recognition","currentSign","current","onResults","results","canvas","ctx","getContext","clearRect","width","height","save","scale","translate","image","drawImage","multiHandLandmarks","landmarks","HAND_CONNECTIONS","color","lineWidth","mirroredLandmarks","map","landmark","x","restore","Hands","locateFile","file","setOptions","maxNumHands","modelComplexity","minDetectionConfidence","minTrackingConfidence","Camera","video","onFrame","send","start","window","SpeechRecognition","webkitSpeechRecognition","continuous","interimResults","lang","onresult","event","toLowerCase","trim","onerror","e","onend","error","stop","close","renderDebugInfo","className","children","fileName","_jsxFileName","lineNumber","columnNumber","round","Object","entries","extensions","finger","value","style","ref","display","mirrored","_c","$RefreshReg$"],"sources":["C:/Users/user/sol-fa-app/src/components/EnhancedHandDetection.js"],"sourcesContent":["import React, { useRef, useEffect, useState, useCallback } from 'react';\r\nimport Webcam from 'react-webcam';\r\nimport * as hands from '@mediapipe/hands';\r\nimport * as camera from '@mediapipe/camera_utils';\r\nimport { drawConnectors, drawLandmarks } from '@mediapipe/drawing_utils';\r\nimport { recognizeKodalySign } from '../utils/kodalySignsDB';\r\nimport { audioPlayer } from '../utils/audioUtils';\r\nimport './HandDetection.css';\r\n\r\nconst CONFIDENCE_THRESHOLD = 0.85;\r\nconst HOLD_FRAMES = 10;\r\n\r\nfunction EnhancedHandDetection() {\r\n    const webcamRef = useRef(null);\r\n    const canvasRef = useRef(null);\r\n    const handsRef = useRef(null);\r\n    const cameraRef = useRef(null);\r\n    const voiceRecognitionRef = useRef(null);\r\n    \r\n    const [detectionState, setDetectionState] = useState({\r\n        sign: null,\r\n        confidence: 0,\r\n        debug: null,\r\n        handPresent: false\r\n    });\r\n    \r\n    const [voiceState, setVoiceState] = useState({\r\n        isActive: false,\r\n        lastCommand: null,\r\n        isSupported: false\r\n    });\r\n    \r\n    const [compositionState, setCompositionState] = useState({\r\n        notes: [],\r\n        currentOctave: 4,\r\n        isRecording: false\r\n    });\r\n\r\n    const lastSignRef = useRef(null);\r\n    const frameCountRef = useRef(0);\r\n\r\n    // Voice command handler\r\n    const handleVoiceCommand = useCallback((transcript) => {\r\n        console.log('Voice command:', transcript);\r\n        \r\n        if (transcript.includes('add') && detectionState.sign) {\r\n            // Add current note to composition\r\n            setCompositionState(prev => ({\r\n                ...prev,\r\n                notes: [...prev.notes, {\r\n                    note: detectionState.sign,\r\n                    octave: prev.currentOctave,\r\n                    timestamp: Date.now()\r\n                }]\r\n            }));\r\n            audioPlayer.playUIFeedback(1200, 200);\r\n            setVoiceState(prev => ({ ...prev, lastCommand: 'Added note: ' + detectionState.sign.toUpperCase() }));\r\n        }\r\n        else if (transcript.includes('octave up') || transcript.includes('higher')) {\r\n            setCompositionState(prev => ({\r\n                ...prev,\r\n                currentOctave: Math.min(prev.currentOctave + 1, 7)\r\n            }));\r\n            audioPlayer.playUIFeedback(1000);\r\n            setVoiceState(prev => ({ ...prev, lastCommand: 'Octave up' }));\r\n        }\r\n        else if (transcript.includes('octave down') || transcript.includes('lower')) {\r\n            setCompositionState(prev => ({\r\n                ...prev,\r\n                currentOctave: Math.max(prev.currentOctave - 1, 2)\r\n            }));\r\n            audioPlayer.playUIFeedback(600);\r\n            setVoiceState(prev => ({ ...prev, lastCommand: 'Octave down' }));\r\n        }\r\n        else if (transcript.includes('play') || transcript.includes('playback')) {\r\n            playComposition();\r\n            setVoiceState(prev => ({ ...prev, lastCommand: 'Playing composition' }));\r\n        }\r\n        else if (transcript.includes('clear') || transcript.includes('reset')) {\r\n            setCompositionState(prev => ({\r\n                ...prev,\r\n                notes: []\r\n            }));\r\n            audioPlayer.playUIFeedback(400, 300);\r\n            setVoiceState(prev => ({ ...prev, lastCommand: 'Composition cleared' }));\r\n        }\r\n        else if (transcript.includes('undo') || transcript.includes('remove last')) {\r\n            setCompositionState(prev => ({\r\n                ...prev,\r\n                notes: prev.notes.slice(0, -1)\r\n            }));\r\n            audioPlayer.playUIFeedback(500);\r\n            setVoiceState(prev => ({ ...prev, lastCommand: 'Last note removed' }));\r\n        }\r\n    }, [detectionState.sign]);\r\n\r\n    const playComposition = useCallback(() => {\r\n        if (compositionState.notes.length === 0) {\r\n            audioPlayer.playUIFeedback(400, 300);\r\n            return;\r\n        }\r\n\r\n        compositionState.notes.forEach((noteItem, index) => {\r\n            setTimeout(() => {\r\n                audioPlayer.playNote(noteItem.note, noteItem.octave);\r\n                setTimeout(() => audioPlayer.stopNote(), 400);\r\n            }, index * 500);\r\n        });\r\n    }, [compositionState.notes]);\r\n\r\n    const handleSignDetection = useCallback((recognition) => {\r\n        const currentSign = recognition?.sign;\r\n        const confidence = recognition?.confidence || 0;\r\n\r\n        if (currentSign && confidence >= CONFIDENCE_THRESHOLD) {\r\n            if (currentSign === lastSignRef.current) {\r\n                frameCountRef.current++;\r\n                if (frameCountRef.current >= HOLD_FRAMES) {\r\n                    audioPlayer.playNote(currentSign, compositionState.currentOctave);\r\n                }\r\n            } else {\r\n                frameCountRef.current = 0;\r\n                lastSignRef.current = currentSign;\r\n                audioPlayer.stopNote();\r\n            }\r\n        } else {\r\n            frameCountRef.current = 0;\r\n            lastSignRef.current = null;\r\n            audioPlayer.stopNote();\r\n        }\r\n    }, [compositionState.currentOctave]);\r\n\r\n    const onResults = useCallback((results) => {\r\n        const canvas = canvasRef.current;\r\n        if (!canvas) return;\r\n\r\n        const ctx = canvas.getContext('2d');\r\n        \r\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n        ctx.save();\r\n        ctx.scale(-1, 1);\r\n        ctx.translate(-canvas.width, 0);\r\n\r\n        if (results.image) {\r\n            ctx.drawImage(results.image, 0, 0, canvas.width, canvas.height);\r\n        }\r\n\r\n        if (results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {\r\n            for (const landmarks of results.multiHandLandmarks) {\r\n                drawConnectors(ctx, landmarks, hands.HAND_CONNECTIONS, {\r\n                    color: '#00FF00',\r\n                    lineWidth: 5\r\n                });\r\n                drawLandmarks(ctx, landmarks, {\r\n                    color: '#FF0000',\r\n                    lineWidth: 2\r\n                });\r\n\r\n                const mirroredLandmarks = landmarks.map(landmark => ({\r\n                    ...landmark,\r\n                    x: 1 - landmark.x\r\n                }));\r\n\r\n                const recognition = recognizeKodalySign(mirroredLandmarks);\r\n                handleSignDetection(recognition);\r\n                setDetectionState({\r\n                    ...recognition,\r\n                    handPresent: true\r\n                });\r\n            }\r\n        } else {\r\n            handleSignDetection(null);\r\n            setDetectionState({\r\n                sign: null,\r\n                confidence: 0,\r\n                debug: null,\r\n                handPresent: false\r\n            });\r\n        }\r\n\r\n        ctx.restore();\r\n    }, [handleSignDetection]);\r\n\r\n    useEffect(() => {\r\n        if (!webcamRef.current) return;\r\n\r\n        // Fixed MediaPipe loading for GitHub Pages\r\n        handsRef.current = new hands.Hands({\r\n            locateFile: (file) => {\r\n                // Try multiple CDN sources for reliability\r\n                return `https://cdn.jsdelivr.net/npm/@mediapipe/hands@0.4.1646424915/${file}`;\r\n            }\r\n        });\r\n\r\n        handsRef.current.setOptions({\r\n            maxNumHands: 1,\r\n            modelComplexity: 1,\r\n            minDetectionConfidence: 0.7,\r\n            minTrackingConfidence: 0.7\r\n        });\r\n\r\n        handsRef.current.onResults(onResults);\r\n\r\n        if (webcamRef.current) {\r\n            cameraRef.current = new camera.Camera(webcamRef.current.video, {\r\n                onFrame: async () => {\r\n                    if (webcamRef.current && handsRef.current) {\r\n                        await handsRef.current.send({\r\n                            image: webcamRef.current.video\r\n                        });\r\n                    }\r\n                },\r\n                width: 640,\r\n                height: 480\r\n            });\r\n            cameraRef.current.start();\r\n        }\r\n\r\n        // Setup voice recognition automatically\r\n        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {\r\n            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\r\n            voiceRecognitionRef.current = new SpeechRecognition();\r\n            \r\n            voiceRecognitionRef.current.continuous = true;\r\n            voiceRecognitionRef.current.interimResults = false;\r\n            voiceRecognitionRef.current.lang = 'en-US';\r\n            \r\n            voiceRecognitionRef.current.onresult = (event) => {\r\n                const transcript = event.results[event.results.length - 1][0].transcript.toLowerCase().trim();\r\n                handleVoiceCommand(transcript);\r\n            };\r\n            \r\n            voiceRecognitionRef.current.onerror = () => {\r\n                setTimeout(() => {\r\n                    try { voiceRecognitionRef.current.start(); } catch (e) {}\r\n                }, 1000);\r\n            };\r\n            \r\n            voiceRecognitionRef.current.onend = () => {\r\n                setTimeout(() => {\r\n                    try { voiceRecognitionRef.current.start(); } catch (e) {}\r\n                }, 100);\r\n            };\r\n\r\n            // Auto-start voice recognition\r\n            setTimeout(() => {\r\n                try {\r\n                    voiceRecognitionRef.current.start();\r\n                    setVoiceState(prev => ({ ...prev, isActive: true, isSupported: true }));\r\n                    console.log('Voice recognition auto-started');\r\n                } catch (error) {\r\n                    console.error('Voice recognition failed to start:', error);\r\n                }\r\n            }, 2000);\r\n        }\r\n\r\n        return () => {\r\n            if (cameraRef.current) {\r\n                cameraRef.current.stop();\r\n            }\r\n            if (handsRef.current) {\r\n                handsRef.current.close();\r\n            }\r\n            if (voiceRecognitionRef.current) {\r\n                voiceRecognitionRef.current.stop();\r\n            }\r\n            audioPlayer.stopNote();\r\n        };\r\n    }, [onResults, handleVoiceCommand]);\r\n\r\n    const renderDebugInfo = useCallback(() => {\r\n        if (!detectionState.handPresent) {\r\n            return (\r\n                <div className=\"debug-panel\">\r\n                    <div className=\"status-message\">No Hand Detected</div>\r\n                    <div className=\"debug-data\">\r\n                        <p>Waiting for hand to appear in frame...</p>\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className=\"debug-panel\">\r\n                <div className=\"status-message\">\r\n                    {detectionState.sign \r\n                        ? `Detected: ${detectionState.sign.toUpperCase()}${compositionState.currentOctave} (${Math.round(detectionState.confidence * 100)}% confident)`\r\n                        : \"Hand Detected - No Sign Recognized\"}\r\n                </div>\r\n                <div className=\"debug-data\">\r\n                    <h3>Hand Analysis:</h3>\r\n                    {detectionState.debug && (\r\n                        <>\r\n                            <div className=\"debug-section\">\r\n                                <h4>Finger Extensions:</h4>\r\n                                {Object.entries(detectionState.debug.extensions).map(([finger, value]) => (\r\n                                    <div key={finger} className=\"debug-item\">\r\n                                        <span>{finger}:</span>\r\n                                        <div className=\"debug-bar\" style={{width: `${value * 100}%`}}></div>\r\n                                        <span>{Math.round(value * 100)}%</span>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                            <div className=\"debug-section\">\r\n                                <h4>Voice Commands:</h4>\r\n                                <div className={`voice-status ${voiceState.isActive ? 'active' : 'inactive'}`}>\r\n                                    {voiceState.isSupported ? \r\n                                        (voiceState.isActive ? '🎤 Voice Active' : '🎤 Starting...') : \r\n                                        '❌ Not Supported'\r\n                                    }\r\n                                </div>\r\n                                {voiceState.lastCommand && (\r\n                                    <div className=\"last-command\">\r\n                                        {voiceState.lastCommand}\r\n                                    </div>\r\n                                )}\r\n                                <div className=\"voice-commands-list\">\r\n                                    <small>\r\n                                        Say: \"Add\" | \"Octave up\" | \"Octave down\" | \"Play\" | \"Clear\" | \"Undo\"\r\n                                    </small>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"debug-section\">\r\n                                <h4>Composition:</h4>\r\n                                <p>Octave: {compositionState.currentOctave}</p>\r\n                                <p>Notes: {compositionState.notes.length}</p>\r\n                                {compositionState.notes.length > 0 && (\r\n                                    <div className=\"composition-preview\">\r\n                                        {compositionState.notes.slice(-5).map((note, index) => (\r\n                                            <span key={index} className=\"note-item\">\r\n                                                {note.note.toUpperCase()}{note.octave}\r\n                                            </span>\r\n                                        ))}\r\n                                        {compositionState.notes.length > 5 && <span>...</span>}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                            {detectionState.sign && frameCountRef.current >= HOLD_FRAMES && (\r\n                                <div className=\"debug-section playing\">\r\n                                    <h4>Playing Note:</h4>\r\n                                    <p>{detectionState.sign.toUpperCase()}{compositionState.currentOctave}</p>\r\n                                </div>\r\n                            )}\r\n                        </>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        );\r\n    }, [detectionState, voiceState, compositionState]);\r\n\r\n    return (\r\n        <div className=\"hand-detection\">\r\n            <div className=\"main-container\">\r\n                <div className=\"camera-canvas-container\">\r\n                    <Webcam\r\n                        ref={webcamRef}\r\n                        style={{ display: 'none' }}\r\n                        width={640}\r\n                        height={480}\r\n                        mirrored={false}\r\n                    />\r\n                    <canvas\r\n                        ref={canvasRef}\r\n                        width={640}\r\n                        height={480}\r\n                    />\r\n                    {detectionState.sign && (\r\n                        <div className={`sign-indicator ${frameCountRef.current >= HOLD_FRAMES ? 'playing' : ''}`}>\r\n                            <h2>{detectionState.sign.toUpperCase()}{compositionState.currentOctave}</h2>\r\n                        </div>\r\n                    )}\r\n                    \r\n                    {voiceState.isActive && (\r\n                        <div className=\"voice-indicator\">\r\n                            🎤 Voice Active\r\n                        </div>\r\n                    )}\r\n                </div>\r\n                {renderDebugInfo()}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default EnhancedHandDetection;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}